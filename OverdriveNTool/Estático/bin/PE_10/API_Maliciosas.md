# **API Maliciosas**
Aquí veremos qué llamadas a la API de Windows podrían ser maliciosas o con uso frecuente entre desarrolladores de malware con respecto al ejecutable [[10]](https://github.com/5kidRo0t/Malware_Analysis/blob/main/OverdriveNTool/Estático/bin/PE_10/10.zip)

[Conclusiones al final]

---

| File name | Hash SHA-256 |
| --------- | ------------ |
| PE_10 | 351a74c692706f6aff7968e2cec0781caef986344160bd66e5d19852a2e908df |

---

[ **ADVAPI32.dll.AdjustTokenPrivileges** ]

- Se utiliza para permitir o bloquear determinados privilegios específicos de acceso.

[ **KERNEL32.dll.CreateFile** ]

- Crea un nuevo fichero o abre uno existente.

[ **KERNEL32.dll.CreateMutex** ]

- Crea un objeto de exclusión mutua (mutex) que puede ser usado por el malware para asegurar que solo una única instancia del malware se está ejecutando en un sistema en un momento dado.

[ **KERNEL32.dll.CreateProcess** ]

- Crea y lanza un nuevo proceso.

[ **KERNEL32.dll.FindFirstFile/FindNextFile** ]

- Utilizada para buscar a través de un directorio y listar el sistema de ficheros.

[ **KERNEL32.dll.FindResource** ]

- Utilizada para encontrar un recurso en un ejecutable o librería cargada.

[ **KERNEL32.dll.GetModuleFileName** ]

- Devuelve el nombre de fichero de un módulo que está cargado en el proceso actual.

[ **KERNEL32.dll.GetModuleHandle** ]

- Utilizada para obtener un handle a un módulo ya cargado.

[ **KERNEL32.dll.GetProcAddress** ]

- Recupera la dirección de una función de una librería cargada en memoria. Utilizada para importar funciones.

[ **KERNEL32.dll.GetTempPath** ]

- Devuelve la ruta de ficheros temporales. Cuando encontramos esta función debemos comprobar posteriormente en el análisis dinámico si el malware escribe o lee ficheros en la ruta de ficheros temporales, cosa que es mi probable que haga.

[ **KERNEL32.dll.GetTickCount** ]

- Recupera el número de milisegundos desde que el sistema inició.

[ **KERNEL32.dll.GetVersionEx** ]

- Devuelve información de qué versión de Microsoft Windows se está ejecutando.

[ **KERNEL32.dll.GetWindowsDirectory** ]

- Devuelve la ruta del directorio del sistema operativo (Ej. C\Windows).

[ **KERNEL32.dll.LoadLibrary** ]

- Carga una librería en un proceso que pudiera no haberse cargado cuando el programa inció. Importada por casi todos los programas Win32.

[ **KERNEL32.dll.LoadResource** ]

- Carga un recurso de un fichero PE en memoria.

[ **KERNEL32.dll.QueryPerformanceCounter** ]

- Utilizada para recuperar el valor del contador de rendimiento basado en hardware. Puede ser usada como técnica anti-debugging.

[ **ADVAPI32.dll.RegOpenKey/Delete/Close** ]

- Manipulación de los registros de Windows, algo habitual tanto por malware como por software legítimo.

[ **KERNEL32.dll.SetFileTime** ]

- Modifica los MAC times de un fichero. Puede ser usado para ocultar actividad maliciosa.

# **Conclusiones:**

- Buenooooo pues en esta ocasión no me queda realmente claro de que funciones se encarga este PE_10 hablando en un contexto malicioso, podría encargarse de inyectar código por lo que podemos observar aquí, ganar persistencia, ocultar actividades maliciosas o incluso simplemente puede servir como distracción, pues muchas veces los desarrolladores de malware intentan desconcertar a los analistas. 
En caso de que su función sea la de ocultar la actividad y ganar persistencia estaríamos ante el fragmento del malware que se considera como Rootkit.





