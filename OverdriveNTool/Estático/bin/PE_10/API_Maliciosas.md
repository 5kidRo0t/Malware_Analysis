# **API Maliciosas**
Aqu칤 veremos qu칠 llamadas a la API de Windows podr칤an ser maliciosas o con uso frecuente entre desarrolladores de malware con respecto al ejecutable [[10]](https://github.com/5kidRo0t/Malware_Analysis/blob/main/OverdriveNTool/Est치tico/bin/PE_10/10.zip)

游녢游낕游녢游낕 [Conclusiones al final] 游녢游낕游녢游낕

---

| File name | Hash SHA-256 |
|-|-|
| PE_10 | 351a74c692706f6aff7968e2cec0781caef986344160bd66e5d19852a2e908df |

---

[ **ADVAPI32.dll.AdjustTokenPrivileges** ]

- Se utiliza para permitir o bloquear determinados privilegios espec칤ficos de acceso.

[ **KERNEL32.dll.CreateFile** ]

- Crea un nuevo fichero o abre uno existente.

[ **KERNEL32.dll.CreateMutex** ]

- Crea un objeto de exclusi칩n mutua (mutex) que puede ser usado por el malware para asegurar que solo una 칰nica instancia del malware se est치 ejecutando en un sistema en un momento dado.

[ **KERNEL32.dll.CreateProcess** ]

- Crea y lanza un nuevo proceso.

[ **KERNEL32.dll.FindFirstFile/FindNextFile** ]

- Utilizada para buscar a trav칠s de un directorio y listar el sistema de ficheros.

[ **KERNEL32.dll.FindResource** ]

- Utilizada para encontrar un recurso en un ejecutable o librer칤a cargada.

[ **KERNEL32.dll.GetModuleFileName** ]

- Devuelve el nombre de fichero de un m칩dulo que est치 cargado en el proceso actual.

[ **KERNEL32.dll.GetModuleHandle** ]

- Utilizada para obtener un handle a un m칩dulo ya cargado.

[ **KERNEL32.dll.GetProcAddress** ]

- Recupera la direcci칩n de una funci칩n de una librer칤a cargada en memoria. Utilizada para importar funciones.

[ **KERNEL32.dll.GetTempPath** ]

- Devuelve la ruta de ficheros temporales. Cuando encontramos esta funci칩n debemos comprobar posteriormente en el an치lisis din치mico si el malware escribe o lee ficheros en la ruta de ficheros temporales, cosa que es mi probable que haga.

[ **KERNEL32.dll.GetTickCount** ]

- Recupera el n칰mero de milisegundos desde que el sistema inici칩.

[ **KERNEL32.dll.GetVersionEx** ]

- Devuelve informaci칩n de qu칠 versi칩n de Microsoft Windows se est치 ejecutando.

[ **KERNEL32.dll.GetWindowsDirectory** ]

- Devuelve la ruta del directorio del sistema operativo (Ej. C\Windows).

[ **KERNEL32.dll.LoadLibrary** ]

- Carga una librer칤a en un proceso que pudiera no haberse cargado cuando el programa inci칩. Importada por casi todos los programas Win32.

[ **KERNEL32.dll.LoadResource** ]

- Carga un recurso de un fichero PE en memoria.

[ **KERNEL32.dll.QueryPerformanceCounter** ]

- Utilizada para recuperar el valor del contador de rendimiento basado en hardware. Puede ser usada como t칠cnica anti-debugging.

[ **ADVAPI32.dll.RegOpenKey/Delete/Close** ]

- Manipulaci칩n de los registros de Windows, algo habitual tanto por malware como por software leg칤timo.

[ **KERNEL32.dll.SetFileTime** ]

- Modifica los MAC times de un fichero. Puede ser usado para ocultar actividad maliciosa.

# **Conclusiones:**

- Buenooooo pues en esta ocasi칩n no me queda realmente claro de que funciones se encarga este PE_10 hablando en un contexto malicioso, podr칤a encargarse de inyectar c칩digo por lo que podemos observar aqu칤, ganar persistencia, ocultar actividades maliciosas o incluso simplemente puede servir como distracci칩n, pues muchas veces los desarrolladores de malware intentan desconcertar a los analistas. 
En caso de que su funci칩n sea la de ocultar la actividad y ganar persistencia estar칤amos ante el fragmento del malware que se considera como Rootkit.





